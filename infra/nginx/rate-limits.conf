# Rate limiting zones for Snippetly
# These must be defined in the http context

# General API rate limit: 10 requests per second per IP
limit_req_zone $binary_remote_addr zone=api_limit:10m rate=10r/s;

# Authentication endpoints: 5 requests per minute per IP (stricter)
limit_req_zone $binary_remote_addr zone=auth_limit:10m rate=5r/m;

# Registration endpoint: 3 requests per hour per IP (very strict)
limit_req_zone $binary_remote_addr zone=register_limit:10m rate=3r/m;

# Password reset: 2 requests per hour per IP
limit_req_zone $binary_remote_addr zone=password_limit:10m rate=2r/m;

# Connection limiting (max concurrent connections per IP)
limit_conn_zone $binary_remote_addr zone=conn_limit:10m;
